------------------------------------------------------------------------

title: "ExÃ¡men EstadÃ­stica I" author: "Maximiliano Sala Crist ci 4857436-4, Esteban Cardoso ci 4742670-6" linestretch: "1.5" format: pdf: toc: true number-sections: true fig_caption: yes keep_tex: true editor: visual lang: "es" ---

```{r include=FALSE}
library(tidyverse)
library(dplyr)
library(lmtest)
library(MASS)
options(scipen = 999)
```

```{r}
df <- read.csv('NoComunicables.csv')[,c(2:17)]
```

\newpage

# IntroducciÃ³n

El presente documento pretende esbozar a travÃ©s del anÃ¡lisis de un modelo de regresiÃ³n lineal mÃºltiple, cuÃ¡les son aquellas variables independientes x que mejor explican nuestra variable dependiente y, considerada en este documento como la tasa de enfermedades no transmisibles, entendidas como el "...*grupo de enfermedades que no son causadas principalmente por una infecciÃ³n aguda, dan como resultado consecuencias para la salud a largo plazo y con frecuencia crean una necesidad de tratamiento y cuidados a largo plazo*." Este grupo comprende enfermedades cardiovasculares, tipos de cÃ¡ncer, diabetes y enfermedades pulmonares crÃ³nicas. Para ello, analizamos un dataset con las tasas de las muertes por enfermedades no transmisibles de cada paÃ­s y un conjunto de variables asociadas a la misma que podrÃ­an explicarla.

# SelecciÃ³n de variables y planteamiento de hipÃ³tesis

Para poder llevar adelante nuestro anÃ¡lisis partimos de la selecciÃ³n de tres variables independientes x que consideramos claves en la explicaciÃ³n de nuestra variable dependiente y. Recordar que en la explicaciÃ³n del modelo de regresiÃ³n lineal mÃºltiple es clave comprender que se estarÃ¡ trabajando bajo el supuesto de ceteris paribus.

Las hipÃ³tesis que se intentan probar toman un modelo con tres factores:

**H0â€‹**: No hay relaciÃ³n significativa entre las variables independientes personas con enfermedades renales, personas que trabajan en entornos de riesgos ocupacionales y personas con presiÃ³n alta, con nuestra variable dependiente tasa de enfermedades no transmisibles.Â  De modo que se cumple:

ğœ·0 + ğœ·1Kidney_dysfunction + ğœ·2Occupational_risks + ğœ·3High_pressure = 0

**H1**: Al menos una de nuestras variables independientes tiene un efecto significativo en nuestra variable dependiente. De modo que se cumple:

Existe por lo menos un i tal que ğœ·i â‰ â€‹ 0

```{r}
# Seleccione hasta tres variables que usted crea que pueden modelar a la variable de respuesta

df_3var <- df %>% dplyr::select(NoComunicables, High_pressure, Occupational_risks, Kidney_dysfunction)
```

1 - Tres variables seleccionadas: Personas con enfermedades renales, Personas que trabajan en entornos de riesgos ocupacionales y Personas con presiÃ³n alta.

```{r}
# Â¿CuÃ¡les son las correlaciones de estas variables con la variable de respuesta? Â¿Es razonable hacer este modelo?, en caso contrario, cambie las variables explicativas.

cor(df_3var)
```

2 - CorrelaciÃ³n de 0.945, nos encontramos ante una correlaciÃ³n positiva y fuerte.

3 - 0.945, da la pauta de que un 94.5% de las enfermedades no transmisibles son explicadas por personas que tienen enfermedades renales, presiÃ³n alta y trabajan en lugares de riesgo.

4 - Modelo teÃ³rico = No transmisibles = ğœ·0 + ğœ·1Kidney_dysfunction + ğœ·2Occupational_risks + ğœ·3High_pressure + ğ›†

Modelo estimado = No transmisibles = 53.41923 + 3.50669Kidney_dysfunction + 14.95202Occupational_risks + 1.45480High_pressure

# Explique como afectan las variables explicativas a la variable a explicar.

# Indique el modelo estimado

```{r}
# Â¿El modelo es significativo?Â¿Las variables son significativas? Â¿CÃ³mo se intrepreta cada parÃ¡metro?

# Â¿CuÃ¡nto de la variable de interÃ©s explica el modelo?

modelo<-lm(NoComunicables ~ High_pressure + Occupational_risks + Kidney_dysfunction, data=df_3var)
summary(modelo)
```

El modelo explica un de la variable de interÃ©s.

```{r}
# Â¿Se cumplen los supuestos de los residuos (errores)?

#Normalidad
qqnorm(modelo$residuals)
qqline(modelo$residuals, col = "red")
shapiro.test(modelo$residuals)

#Homocedasticidad
bptest(modelo)
```

```{r}
# Si aplicamos una estrategia de selecciÃ³n automÃ¡tica de variables, Â¿CÃ³mo queda el modelo estimado? (Recuerde cargar la librerÃ­a MASS)


```

```{r}
#Independencia de los residuos
# dwtest(modelo)
```
